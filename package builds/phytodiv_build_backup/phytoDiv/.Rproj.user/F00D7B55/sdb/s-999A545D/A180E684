{
    "collab_server" : "",
    "contents" : "#' Assign a morphofunctional group based on binary functional traits and higher taxonomy\n#'\n#' @param flagella 1 if flagella are present, 0 if they are absent.\n#' @param size Character string: 'large' or 'small'. Classification criteria is left to the user.\n#' @param colonial 1 if typically colonial growth form, 0 if typically unicellular.\n#' @param filament 1 if dominant growth form is filamentous, 0 if not.\n#' @param centric 1 if diatom with centric growth form, 0 if not. NA for non-diatoms.\n#' @param gelatinous 1 mucilagenous sheath is typically present, 0 if not.\n#' @param aerotopes 1 if aerotopes allowing buoyancy regulation are typically present, 0 if not.\n#' @param class The taxonomic class of the species; We recommend algaebase as a standard reference.\n#' @param order The taxonomic order of the species; We recommend algaebase as a standard reference.\n#'\n#' @return A character string of the species' morphofunctional group\n#' @example traits_to_mfg(1,\"large\",1,0,NA,0,0,\"Euglenophyceae\",\"Euglenales\")\n\ntraits_to_mfg <- function(flagella = NA,\n                         size = NA,\n                         colonial = NA,\n                         filament = NA,\n                         centric = NA,\n                         gelatinous = NA,\n                         aerotopes = NA,\n                         class = NA,\n                         order = NA)\n{\n  mfg = NA\n  if (flagella ==  1 &\n      !is.na(flagella) &\n      (class == \"Bacillariophyceae\" |\n       class == \"Coscinodiscophyceae\" |\n       class == \"Mediophyceae\" |\n       class == \"Fragilariophyceae\")==F) {#making sure that diatoms are excluded from this branch\n    if (order == \"Volvocales\" & !is.na(order)){\n      if (colonial == 1 & !is.na(colonial)) {\n        mfg = \"3b-ColoPhyto\"\n        }\n      else {\n          mfg = \"3a-UnicPhyto\"\n      }\n    }else if(class=='Cryptophyceae' & !is.na(class)){#ensures that all motile cryptophytes go to 2d.\n        mfg =  \"2d-Crypto\"\n    }else\n      if (size == \"large\" & !is.na(size)) {\n        if (class == \"Chrysophyceae\" |\n            class == \"Haptophyceae\" |\n            class == \"Synurophyceae\" |\n            class == \"Phaeothamniophyceae\") {\n          mfg = \"1a-LargeChry\"\n          }\n        else\n          if (class == \"Dinophyceae\") {\n          mfg = \"1b-LargeDino\"\n          }\n          else {\n            mfg = \"1c-LargeEugl\"\n          }\n        }\n      else\n        if (class == \"Chrysophyceae\" |\n            class == \"Haptophyceae\" |\n            class == \"Synurophyceae\" |\n            class == \"Phaeothamniophyceae\") {\n          mfg = \"2a-SmallChry1\"\n          }\n        else\n          if (class == \"Dinophyceae\"){\n            mfg = \"2b-SmallDino\"\n          }\n    else\n      if (class == \"Euglenophyceae\") {\n              mfg = \"2c-SmallEugl\"\n            }\n    else {\n          mfg = NA\n      }\n    }\n  # first node break: flagella == 0\n  else\n    if (class == \"Cyanophyceae\" |\n        class == \"Cyanobacteria\"){\n      if (colonial == 1 & !is.na(colonial)){\n        if (order == \"Oscillatoriales\" & !is.na(order)){\n          mfg = \"5a-FilaCyano\"\n        }\n        else\n          if (order == \"Nostocales\" & !is.na(order)){\n            mfg = \"5e-Nostocales\"\n          }\n        else\n          if (size == \"large\" & !is.na(size)) {\n            if (aerotopes == 1 & !is.na(aerotopes)){\n              mfg = \"5b-LargeVacC\"\n            }\n            else {\n              mfg = \"5c-OtherChroo\"\n            }\n          }\n        else{\n          mfg = \"5d-SmallChroo\"\n        }\n      }\n      else{\n        mfg = \"4-UnicCyano\"\n      }\n    }\n  else\n    if (class == \"Bacillariophyceae\" |\n        class == \"Coscinodiscophyceae\"  |\n        class == \"Mediophyceae\" |\n        class == \"Fragilariophyceae\"){\n      if (size == \"large\" & !is.na(size)) {\n        if (centric == 1 & !is.na(centric)) {\n          if (colonial == 1 & !is.na(colonial)) {\n            mfg = \"6a1-LColCent\"\n          }\n          else {\n            mfg = \"6a2-LUniCent\"\n          }\n        }\n        else\n          if (colonial == 1 & !is.na(colonial)){\n            mfg = \"6b1-LColPenn\"\n          }\n        else {\n          mfg = \"6b2-LUniPenn\"\n        }\n      }\n      else\n        if (centric == 1 & !is.na(centric)) {\n          mfg = \"7a-SmallCent\"\n        }\n      else {\n        mfg = \"7b-SmallPenn\"\n      }\n    }\n  else\n    if (colonial == 1 & !is.na(colonial)){\n      if (filament == 1 & !is.na(filament)) {\n        if (class == \"Chlorophyceae\" |\n            class == \"Ulvophyceae\" |\n            class == \"Trebouxiophyceae\"){\n          mfg = \"10a-FilaChlorp\"\n          }\n        else\n          if (class == \"Conjugatophyceae\" |\n              class == \"Zygnematophyceae\"){\n          mfg = \"10b-FilaConj\"\n          }\n        else\n          if (class == \"Xanthophyceae\" |\n              class == 'Eustigmatophyceae') {\n          mfg = \"10c-FilaXant\"\n          }\n      }\n      else\n        if (order == \"Chlorococcales\" |\n            order == \"Chlamydomonadales\" |\n            order == \"Tetrasporales\" & !is.na(order)) {\n            if (gelatinous == 1 & !is.na(gelatinous)) {\n            mfg = \"11b-GelaChlor\"\n            }\n            else {\n            mfg = \"11a-NakeChlor\"\n            }\n          }\n      else {\n        mfg = \"11c-OtherCol\"\n      }\n        }\n      else\n    if (size == \"large\" & !is.na(size)) {\n      if (class == \"Chlorophyceae\" |\n          class == \"Conjugatophyceae\" |\n          class == \"Zygnematophyceae\") {\n        mfg = \"8a-LargeCoCh\"\n      }\n      else {\n        mfg = \"8b-LargeUnic\"\n      }\n    }\n  else\n    if (class == \"Conjugatophyceae\"|\n        class == \"Zygnematophyceae\"){\n      mfg = \"9a-SmallConj\"\n    }\n  else\n    if (order == \"Chlorococcales\" & !is.na(order)) {\n      mfg = \"9b-SmallChlor\"\n    }\n  else\n    if (class == \"Chrysophyceae\" |\n        class == \"Synurophyceae\" |\n        class == \"Phaeothamniophyceae\") {\n      mfg = \"9c-SmallChry2\"\n    }\n  else {\n    mfg = \"9d-SmallUnic\"\n  }\n\n  return(mfg)\n}\n\n\n\n\n",
    "created" : 1525726480528.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2571301329",
    "id" : "A180E684",
    "lastKnownWriteTime" : 1525726963,
    "last_content_update" : 1525726963437,
    "path" : "~/gleon/Geisha/phyto_package/GEISHA_phytoplankton_github_shared/phytoDiv/phytoDiv/R/traits_to_mfg.R",
    "project_path" : "R/traits_to_mfg.R",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}